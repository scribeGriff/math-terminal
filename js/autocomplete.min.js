function attr(a,b,c){if(null!==a){if("string"==typeof b)return a.hasAttribute(b)?a.getAttribute(b):c;for(var d in b)a.setAttribute(d,b[d])}}function attrClass(a,b){if(null!==a){if(void 0===b)return attr(a,"class");attr(a,{"class":b})}}function domCreate(a){return document.createElement(a)}var AutoComplete=function(){"use strict";function a(a,b){attr(b,{"class":"autocomplete",style:"top:"+(a.offsetTop+a.offsetHeight)+"px;left:"+a.offsetLeft+"px;width:"+a.clientWidth+"px;"})}function b(a,b,c,d,e){a&&a.abort();var f=b.method,g=b.url;return f.match(/^GET$/i)&&(g+="?"+c),a=new XMLHttpRequest,a.open(f,g,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&b.post(e,a.response,b)!==!0&&b.open(d,e)},a.send(c),a}function c(a,b){b?attrClass(a,"autocomplete"):setTimeout(function(){c(a,!0)},150)}function d(a,b){var c={};for(var d in a)c[d]=a[d];for(var e in b)c[e]=b[e];return c}var e=function(f){if(this){var g,h=this,i={limit:0,method:"GET",noResult:"No result",paramName:"q",select:function(a,b){attr(a,{"data-autocomplete-old-value":a.value=attr(b,"data-autocomplete-value",b.innerHTML)})},open:function(a,b){var c=this;Array.prototype.forEach.call(b.getElementsByTagName("li"),function(b){b.onclick=function(b){c.select(a,b.target)}})},post:function(a,b,c){try{b=JSON.parse(b);var d,e,f,g,h=function(){return domCreate("li")},i=function(a,b){return 0>b?a.reverse():a},j=function(a,b,c){return b.innerHTML=c,a.appendChild(b),h()},k=0,l=b.length,m=h(),n=domCreate("ul"),o=c.limit;if(Array.isArray(b))if(l)for(b=i(b,o);l>k&&(k<Math.abs(o)||!o);k++)m=j(n,m,b[k]);else d=!0,attrClass(m,"locked"),m=j(n,m,c.noResult);else{f=i(Object.getOwnPropertyNames(b),o);for(e in f)g=f[e],(parseInt(e)<Math.abs(o)||!o)&&(attr(m,{"data-autocomplete-value":g}),m=j(n,m,b[g]))}return a.hasChildNodes()&&a.childNodes[0].remove(),a.appendChild(n),d}catch(p){a.innerHTML=b}},pre:function(a){return a.value},selector:["input[data-autocomplete]"]};h._custArgs=[],h._args=d(i,f||{}),h._args.method.match(/^GET|POST$/i)||(h._args.method=i.method),g=h._args.selector,Array.isArray(g)||(g=[g]),g.forEach(function(d){Array.prototype.forEach.call(document.querySelectorAll(d),function(d){if(d.nodeName.match(/^INPUT$/i)&&d.type.match(/^TEXT|SEARCH$/i)){var e,f="data-autocomplete-old-value",g=domCreate("div");attr(d,{autocomplete:"off"}),a(d,g),d.addEventListener("position",function(){a(d,g)}),d.parentNode.appendChild(g),d.onfocus=function(){var a=attr(d,f);a&&d.value==a||attrClass(g,"autocomplete open")},d.onblur=function(){c(g)},d.onkeyup=function(a){var c,d=a.keyCode,i=a.target;if(13==d&&-1!=attrClass(g).indexOf("open")&&(c=g.querySelector("li.active"),null!==c&&(h._args.select(i,c),attrClass(g,"autocomplete"))),38==d||40==d)if(c=g.querySelector("li.active"),null===c){var j=g.querySelector("li:first-child:not(.locked)");null!==j&&attrClass(j,"active")}else{var k=Array.prototype.indexOf.call(c.parentNode.children,c);attrClass(c,"");var l=k+(d-39),m=g.getElementsByTagName("li").length;0>l?l=m-1:l>=m&&(l=0),attrClass(c.parentElement.childNodes.item(l),"active")}else if(35>d||d>40){var n=h.CustParams(i),o=n.pre(i);if(o&&n.url){var p=attr(i,f);p&&o==p||attrClass(g,"autocomplete open"),e=b(e,n,n.paramName+"="+o,i,g)}}}}})})}else new e(f)};return e.prototype={CustParams:function(a){var b="data-autocomplete-id",c=this;if(!a.hasAttribute(b)){a.setAttribute(b,c._custArgs.length);for(var e={limit:"data-autocomplete-limit",method:"data-autocomplete-method",noResult:"data-autocomplete-no-result",paramName:"data-autocomplete-param-name",url:"data-autocomplete"},f=Object.getOwnPropertyNames(e),g=f.length-1;g>=0;g--)e[f[g]]=attr(a,e[f[g]]);for(var h in e)e.hasOwnProperty(h)&&!e[h]&&delete e[h];e.method&&!e.method.match(/^GET|POST$/i)&&delete e.method,e.limit&&(isNaN(e.limit)?delete e.limit:e.limit=parseInt(e.limit)),c._custArgs.push(d(this._args,e))}return c._custArgs[attr(a,b)]}},e}();
//# sourceMappingURL=autocomplete.min.js.map